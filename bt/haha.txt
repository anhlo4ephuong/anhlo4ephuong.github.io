Phần 1: WordCount sử dụng MapReduce
Mục tiêu
Viết một chương trình MapReduce để đếm số lần xuất hiện của mỗi từ trong một tập tin văn bản.

Yêu cầu
Đầu vào:

Tập tin input_vku.txt chứa đoạn văn bản đã cung cấp.
Thực hiện:

Viết chương trình MapReduce bao gồm các bước Mapper và Reducer.
Đầu ra:

Tập tin output_vku.txt chứa mỗi từ duy nhất và số lần xuất hiện của từ đó.
Hướng dẫn thực hiện
1. Tạo tập tin đầu vào
Tạo file input_vku.txt và chèn đoạn văn bản đã cung cấp.

2. Viết chương trình MapReduce
python
Sao chép mã
# Tạo file input_vku.txt
text = """
VKU is located on a 21.5-hectare plot of land within the Urban campus of
the University of Danang, Ngu Hanh Son district, Danang city. With modern
and synchronous construction architecture, invested with more than 1,000
billion VND from the Government of Vietnam and 16.2 million USD from ODA
funded from the Korean Government. Spacious facilities and specialized
teaching support devices are equipped in labs such as: Cloud computing
system, virtual reality, multimedia communication, graphic design,
semiconductor IC design, mobile programming, embedded systems,...; The
library is able to accommodate more than 1,500 students; The Student
Center is combined with an outdoor sports area equipped for recreation,
entertainment, and sports; The dormitory with 3 blocks of 5 floors
accommodates nearly 5,000 students. VKU has a strong team of officials,
managers and lecturers to meet the quantity and quality to implement the
University’s training programs. The number of employees is 285, of which
the number of lecturers is 191 with 07 Associate Professors and 67 Doctors
trained from the countries with advanced education in the world such as
the US, France, Japan, UK, Korea, New Zealand, Poland, Germany,
Australia,... Currently, the training scale is nearly 6,000 students, the
annual enrollment target is 1,500 students with the highest entry score
in the Central – Central Highlands region for 15 majors such as:
Information Technology, Technology Computer Engineering, Artificial
Intelligence, Communication Technology, Information Security, Business
Administration, Marketing, Logistics Administration and Digital Supply
Chain, Digital Financial Administration, Tourism and Travel Service
Management, Information Technology Project Administration, Semiconductor
IC Design. The target by 2025 will be 10,000 undergraduate and
postgraduate students. VKU pursues the educational philosophy “Humanity
– Service – Liberation” to train and develop learners to become
comprehensive, kind, and ethical people with dynamic, innovative, and
creative thinking. The spirit of always being ready to serve and commit
to the happiness and development of the country and humanity based on the
core value system: “Morality – Mind – Body – Beauty; Prestige – Quality
– Professionalism; Inheritance – Innovation – Creativity”. VKU has a
cooperation network of more than 200 partners who are domestic and foreign
businesses, universities, research institutes, members of ACIR
organization,... and is implementing many projects, such as: Project
“Improving education – training, administration and research capacity for
the period 2022 – 2027” from ODA capital of 7.7 million USD from the
Korean Government; HEI ICI, Erasmus+, IPP projects... Based on existing
strengths, with the help of the Korean Government, VKU has the vision of
becoming the leading university in Vietnam qualified by international
standards of training, research, innovation, and technology transfer in
the fields of Information Technology, Communications and Digital Economy
to meet the needs of the 4.0 industrial revolution
"""
with open('input_vku.txt', 'w') as f:
    f.write(text)

# Viết chương trình MapReduce
from mrjob.job import MRJob

class MRWordCount(MRJob):

    def mapper(self, _, line):
        # Tách dòng thành các từ
        for word in line.split():
            # Gửi mỗi từ với giá trị là 1
            yield (word.lower(), 1)

    def reducer(self, word, counts):
        # Tính tổng số lần xuất hiện của mỗi từ
        yield (word, sum(counts))

if __name__ == '__main__':
    MRWordCount.run()
3. Chạy chương trình MapReduce
Chạy chương trình trên Cloudera hoặc bất kỳ môi trường hỗ trợ Hadoop.

bash
Sao chép mã
!python wordcount.py input_vku.txt > output_vku.txt
Phần 2: Làm việc với HDFS
Yêu cầu
Copy file từ Local File System sang HDFS
bash
Sao chép mã
# Tạo folder bigdata trên HDFS
hadoop fs -mkdir /user/hadoop/bigdata

# Tạo file test_vku.txt ở local
echo "VKU with the motto student-centered, pursues the educational philosophy
of Humanity - Service – Liberalization to train and foster learners to
become comprehensive, honest, and ethical people with a mindset of
dynamism, innovation, creativity, and a spirit of being always ready to
serve and commit to happiness and the development of the country and
humanity based on the core value system: Morality – Mind – Body – Beauty;
Prestige – Quality – Professionalism; Inheritance – Innovation - Creation." > test_vku.txt

# Copy file từ local sang HDFS
hadoop fs -copyFromLocal test_vku.txt /user/hadoop/bigdata/
Liệt kê các file trong thư mục HDFS
bash
Sao chép mã
# Liệt kê các file trong thư mục /user/hadoop/bigdata/
hadoop fs -ls /user/hadoop/bigdata/
Copy file từ HDFS về Local File System
bash
Sao chép mã
# Copy file kết quả từ HDFS về local
hadoop fs -copyToLocal /user/hadoop/output/part-r-00000 output_vku.txt
Copy file từ HDFS này sang HDFS khác
bash
Sao chép mã
# Tạo folder vku trên HDFS
hadoop fs -mkdir /user/hadoop/vku

# Copy file từ HDFS này sang HDFS khác
hadoop fs -cp /user/hadoop/bigdata/test_vku.txt /user/hadoop/vku/
Bằng cách thực hiện các bước trên, bạn sẽ hiểu cách sử dụng Hadoop MapReduce để xử lý dữ liệu phân tán và quản lý các tệp trên HDFS.






